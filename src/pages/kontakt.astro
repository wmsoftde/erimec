---
import Layout from '../layouts/Layout.astro';
---

<Layout
  title="Kontakt — ERIMEC Messgeräte"
  description="Kontaktieren Sie ERIMEC für Produktanfragen, technische Beratung oder Support. Wir antworten innerhalb von 24 Stunden."
>

  <!-- ── Page Header ─────────────────────────────────────── -->
  <div class="relative border-b border-line overflow-hidden">
    <div class="absolute inset-0 grid-bg opacity-60"></div>
    <div class="absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-amber/40 to-transparent"></div>

    <div class="relative max-w-7xl mx-auto px-6 pt-16 pb-12">
      <div class="flex items-center gap-2 text-[11px] tracking-widest text-text-dim uppercase mb-8">
        <a href="/" class="hover:text-amber transition-colors">Start</a>
        <span class="text-muted">/</span>
        <span class="text-amber">Kontakt</span>
      </div>
      <div class="flex items-center gap-3 mb-4">
        <span class="w-8 h-px bg-amber"></span>
        <span class="text-amber text-[11px] tracking-[0.4em] uppercase">Wir helfen gerne</span>
      </div>
      <h1 class="font-display text-6xl md:text-7xl tracking-wide">
        KONTAKT<span class="text-amber">.</span>
      </h1>
    </div>
  </div>

  <!-- ── Main content ────────────────────────────────────── -->
  <div class="max-w-7xl mx-auto px-6 py-20">
    <div class="grid grid-cols-1 lg:grid-cols-5 gap-12">

      <!-- ── Contact Info (left) ─────────────────────────── -->
      <div class="lg:col-span-2 space-y-10">

        <!-- Intro -->
        <div>
          <p class="text-text-dim leading-relaxed text-lg">
            Haben Sie Fragen zu unseren Produkten, benötigen Sie eine technische Beratung oder möchten Sie ein Angebot anfordern? Wir stehen Ihnen gerne zur Verfügung.
          </p>
        </div>

        <!-- Contact cards -->
        <div class="space-y-4">
          {[
            {
              icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>`,
              label: 'Adresse',
              value: 'Industriestraße 42\n80339 München\nDeutschland',
            },
            {
              icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>`,
              label: 'Telefon',
              value: '+49 (0) 89 123 456 78',
            },
            {
              icon: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>`,
              label: 'E-Mail',
              value: 'info@erimec.de',
            },
          ].map(item => (
            <div class="border border-line p-5 flex gap-4 hover:border-amber/30 transition-colors duration-300 group">
              <div class="shrink-0 w-10 h-10 border border-line flex items-center justify-center text-amber group-hover:border-amber/50 transition-colors duration-300">
                <Fragment set:html={item.icon} />
              </div>
              <div>
                <div class="text-[10px] tracking-[0.3em] text-text-dim uppercase mb-1">{item.label}</div>
                <div class="text-text text-sm leading-relaxed whitespace-pre-line">{item.value}</div>
              </div>
            </div>
          ))}
        </div>

        <!-- Opening hours -->
        <div class="border border-line p-6">
          <div class="flex items-center gap-3 mb-5">
            <div class="w-2 h-2 bg-amber rounded-full animate-glow"></div>
            <h3 class="font-display tracking-[0.25em] text-amber text-sm">ÖFFNUNGSZEITEN</h3>
          </div>
          <div class="space-y-3">
            {[
              { days: 'Montag – Freitag', hours: '08:00 – 17:00 Uhr', open: true },
              { days: 'Samstag',          hours: '09:00 – 13:00 Uhr', open: true },
              { days: 'Sonntag',          hours: 'Geschlossen',        open: false },
            ].map(row => (
              <div class="flex justify-between items-center py-2 border-b border-line last:border-0">
                <span class="text-text-dim text-sm">{row.days}</span>
                <span class={`text-sm font-mono ${row.open ? 'text-text' : 'text-muted'}`}>{row.hours}</span>
              </div>
            ))}
          </div>
          <div class="mt-5 flex items-center gap-2">
            <span class="w-1.5 h-1.5 rounded-full bg-green-400 animate-blink"></span>
            <span class="text-[11px] tracking-widest text-text-dim uppercase">Jetzt geöffnet</span>
          </div>
        </div>

        <!-- Response time -->
        <div class="border border-amber/20 bg-amber/5 p-5">
          <div class="text-[10px] tracking-[0.3em] text-amber uppercase mb-2">Antwortzeit</div>
          <div class="font-display text-3xl text-amber tracking-widest">< 24h</div>
          <div class="text-text-dim text-sm mt-1">Wir antworten auf alle Anfragen innerhalb eines Werktages.</div>
        </div>
      </div>

      <!-- ── Contact Form (right) ────────────────────────── -->
      <div class="lg:col-span-3">
        <div class="border border-line p-8 md:p-10 amber-glow">
          <!-- Form header -->
          <div class="flex items-center gap-3 mb-8">
            <span class="w-6 h-px bg-amber"></span>
            <h2 class="font-display tracking-[0.2em] text-xl text-text">ANFRAGE SENDEN</h2>
          </div>

          <form id="contact-form" class="space-y-6" novalidate>

            <!-- Name + Email -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="form-group">
                <label class="form-label">Name <span class="text-amber">*</span></label>
                <input
                  type="text"
                  name="name"
                  required
                  placeholder="Max Mustermann"
                  class="form-input"
                />
                <span class="form-error hidden">Bitte geben Sie Ihren Namen ein.</span>
              </div>
              <div class="form-group">
                <label class="form-label">E-Mail <span class="text-amber">*</span></label>
                <input
                  type="email"
                  name="email"
                  required
                  placeholder="max@beispiel.de"
                  class="form-input"
                />
                <span class="form-error hidden">Bitte geben Sie eine gültige E-Mail ein.</span>
              </div>
            </div>

            <!-- Phone + Company -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div class="form-group">
                <label class="form-label">Telefon</label>
                <input
                  type="tel"
                  name="phone"
                  placeholder="+49 89 123 456"
                  class="form-input"
                />
              </div>
              <div class="form-group">
                <label class="form-label">Unternehmen</label>
                <input
                  type="text"
                  name="company"
                  placeholder="Firma GmbH"
                  class="form-input"
                />
              </div>
            </div>

            <!-- Subject -->
            <div class="form-group">
              <label class="form-label">Betreff <span class="text-amber">*</span></label>
              <select name="subject" required class="form-input">
                <option value="">— Bitte wählen —</option>
                <option value="produktanfrage">Produktanfrage</option>
                <option value="angebot">Angebotsanforderung</option>
                <option value="beratung">Technische Beratung</option>
                <option value="reklamation">Reklamation / Service</option>
                <option value="sonstiges">Sonstiges</option>
              </select>
              <span class="form-error hidden">Bitte wählen Sie einen Betreff.</span>
            </div>

            <!-- Message -->
            <div class="form-group">
              <label class="form-label">Nachricht <span class="text-amber">*</span></label>
              <textarea
                name="message"
                required
                rows="5"
                placeholder="Beschreiben Sie Ihr Anliegen oder Ihre Produktanfrage…"
                class="form-input resize-none"
              ></textarea>
              <span class="form-error hidden">Bitte geben Sie eine Nachricht ein.</span>
            </div>

            <!-- Privacy -->
            <div class="flex gap-3 items-start">
              <input type="checkbox" name="privacy" id="privacy" required class="mt-0.5 accent-amber w-4 h-4 shrink-0" />
              <label for="privacy" class="text-text-dim text-sm leading-relaxed cursor-pointer">
                Ich habe die <a href="/datenschutz" class="text-amber hover:underline">Datenschutzerklärung</a> gelesen und stimme der Verarbeitung meiner Daten zu. <span class="text-amber">*</span>
              </label>
            </div>

            <!-- Submit -->
            <div class="pt-2">
              <button
                type="submit"
                id="submit-btn"
                class="w-full relative bg-amber text-bg font-medium text-sm tracking-[0.2em] uppercase py-4 hover:bg-amber-light transition-colors duration-300 overflow-hidden group"
              >
                <span id="btn-text">Anfrage absenden</span>
                <span id="btn-loading" class="hidden">Wird gesendet…</span>
              </button>
            </div>

            <!-- Success message -->
            <div id="form-success" class="hidden border border-green-500/40 bg-green-500/10 p-4 text-sm text-green-400 tracking-wide">
              ✓ Ihre Anfrage wurde erfolgreich übermittelt. Wir melden uns innerhalb von 24 Stunden.
            </div>
          </form>
        </div>

        <!-- Map placeholder -->
        <div class="mt-6 border border-line bg-surface/20 h-52 flex items-center justify-center relative overflow-hidden">
          <div class="absolute inset-0 grid-bg opacity-40"></div>
          <div class="relative text-center">
            <div class="w-12 h-12 border border-amber/40 flex items-center justify-center mx-auto mb-3">
              <svg class="w-6 h-6 text-amber" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
            </div>
            <div class="font-display tracking-widest text-sm text-amber">INDUSTRIESTRASSE 42</div>
            <div class="text-text-dim text-xs tracking-wide mt-1">80339 München, Deutschland</div>
          </div>
          <!-- Decorative crosshair -->
          <div class="absolute top-4 left-4 w-6 h-6 border-t border-l border-line"></div>
          <div class="absolute bottom-4 right-4 w-6 h-6 border-b border-r border-line"></div>
        </div>
      </div>
    </div>
  </div>

</Layout>

<style>
  .form-label {
    display: block;
    font-size: 0.625rem;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--color-text-dim);
    margin-bottom: 0.5rem;
  }
  .form-input {
    width: 100%;
    background: var(--color-bg);
    border: 1px solid var(--color-line);
    color: var(--color-text);
    padding: 0.75rem 1rem;
    font-size: 0.875rem;
    font-family: inherit;
    outline: none;
    transition: border-color 0.2s;
  }
  .form-input::placeholder { color: var(--color-muted); }
  .form-input:focus        { border-color: rgba(200, 130, 10, 0.5); }
  .form-input option       { background: var(--color-surface); }
  .form-error {
    display: block;
    margin-top: 0.35rem;
    font-size: 0.7rem;
    color: #f87171;
    letter-spacing: 0.05em;
  }
</style>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitBtn = document.getElementById('submit-btn');
  const btnText    = document.getElementById('btn-text');
  const btnLoading = document.getElementById('btn-loading');
  const successMsg = document.getElementById('form-success');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    let valid = true;

    // Validate required fields
    const required = form.querySelectorAll('[required]');
    required.forEach((field: Element) => {
      const input = field as HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement;
      const group = input.closest('.form-group');
      const error = group?.querySelector('.form-error');

      const isEmpty = input.type === 'checkbox'
        ? !(input as HTMLInputElement).checked
        : !input.value.trim();

      if (isEmpty) {
        valid = false;
        error?.classList.remove('hidden');
        input.style.borderColor = 'rgba(248, 113, 113, 0.6)';
      } else {
        error?.classList.add('hidden');
        input.style.borderColor = '';
      }
    });

    if (!valid) return;

    // Simulate form submission
    if (btnText)    btnText.classList.add('hidden');
    if (btnLoading) btnLoading.classList.remove('hidden');
    if (submitBtn)  (submitBtn as HTMLButtonElement).disabled = true;

    await new Promise(r => setTimeout(r, 1500));

    if (btnText)    btnText.classList.remove('hidden');
    if (btnLoading) btnLoading.classList.add('hidden');
    if (submitBtn)  (submitBtn as HTMLButtonElement).disabled = false;

    form.reset();
    successMsg?.classList.remove('hidden');

    setTimeout(() => successMsg?.classList.add('hidden'), 6000);
  });
</script>
